= Devoxx France 2019 - Microservices: Spring Cloud vs JEE Microprofile?

Spring Microservices vs MicroProfile JEE

== Darren : 

VoilÃ  la liste des link :

* https://spring.io/guides/gs/rest-service/
* https://spring.io/guides/gs/consuming-rest/
* https://spring.io/guides/gs/spring-boot-docker/
* http://eldermoraes.com/2018/07/31/how-to-implement-microservices-using-microprofile-thorntail-and-eclipse-ide/
* https://developers.redhat.com/blog/2018/11/21/eclipse-microprofile-for-spring-boot-developers/
* https://itnext.io/migrating-a-spring-boot-service-to-kubernetes-in-5-steps-7c1702da81b6
* https://www.e4developer.com/2018/01/21/java-enterprise-and-microservices-meet-microprofile/
* https://medium.com/@the.raj.saxena/springboot-2-performance-servlet-stack-vs-webflux-reactive-stack-528ad5e9dadc
* https://itnext.io/migrating-a-spring-boot-service-to-kubernetes-in-5-steps-7c1702da81b6

== Thomas :

Pour la comparaison de 2 stacks microservices complÃ¨tes, bien penser Ã  :

* comparer l'outillage associÃ©, dont une base va Ãªtre commune (ex : SonarQube ?)

FonctionnalitÃ©s Ã  comparer :

* API Gateway
* Load Balancer
* Service Discovery
* Circuit Breaker

Des exemples d'outils gÃ©rant ces 4 fonctionnalitÃ©s:

* cÃ´tÃ© Netflix OSS : Zuul / Ribbon / Eureka / Hystrix
* cÃ´tÃ© Hashicorp : ??? / Fabio / Consul (trÃ¨s Ã  la mode partout en ce moment) / ???

Netflix est peut-Ãªtre en train d'abandonner une partie de sa stack, ou de la renouveler Voir par exemple Envoy qui pourrait remplacer Zuul : +
https://piotrminkowski.wordpress.com/2017/10/25/envoy-proxy-with-microservices/

Pour la partie sÃ©curitÃ©, dans le EJM, en 206/297, on trouve : +
"Standard protocolsâ€” Out of the box, Keycloak provides support for OpenID Connect, OAuth 2.0, and Security Assertion Markup Language (SAML)."

Dans notre plan de prez, on pourrait rappeler les diffÃ©rents composants d'une stack microservices (API gateway, Service discovery, Load Balancer, etc.) +
il faudrait se dÃ©brouiller pour faire nos exemples Microprofiles et Spring Boot avec les mÃªmes outils en commun (quand possible biensÃ»r) +
il faudrait essayer de garder une trame commune, pour faciliter la comparaison

On pourrait toucher 2 mots des 12 factor app ?

== Plan de la prÃ©sentation

* Refaire un rien d'histoire *trÃ¨s rapide* sur les microservices (dÃ©finition d'A. Cockburn, applications cloud native, qualitÃ© de service et fonctionnalitÃ©s attendues, etc.)

* Rappel de l'env tech des microservices, et de la qualitÃ© de services attendue concernant ces derniers, pour la rÃ©alisation d'une application cloud native :

** API Gateway
** Service Discovery
** Load Balancer
** Circuit Breaker
	**** bulkheads
	**** fallbacks
** Centralised configuration
** monitoring and logging
** security

* Description de la stack Spring Boot et Cloud, et des outils avec lesquels elle s'intÃ¨gre pour rendre la qualitÃ© de service :
	** Netflix OSS
		**** Hystrix
		**** Ribbon -> Eureka
	** Spring actuators (logging monitoring)
	** Spring security

== PrÃ©paration des slides

IMPORTANT : faire les slides en FRANCAIS ! (Devoxx FR est Ã  80% francophone)

Rappelez que les applications sont de plus en plus *cloud native* Ã  l'heure actuelle

The common work of a developper is to:

* develop
* secure (check if we add this step or not?)
* test
* package
* deploy
* monitor
* scale their application

As this can be complex, they generally do rely on frameworks to ease those steps. 

When working with Java, *JEE* and *Spring* and 2 common ones

Taken as is, JEE is a specification for an Application Server dedicated to monolithic webapps, whereas Spring Boot and Cloud are designed to build microservices. +
One could say there is nothing to compare, "just choose Spring", but that's just when Microprofile comes into play.

So let's compare Spring Boot and Cloud and Microprofile, and to do so let's quickly remind ourselves what are microservices.

Microservices originated from the Hexagonal Architecture, also known as Ports and Adapters pattern, coined by Alistair Cockburn. +
He describes microservices as:

____
an architectural style or an approach to building IT systems as aset of business capabilities that are autonomous, self-contained, and loosely coupled.
____

This implies that they need to be:

* small:

.https://dzone.com/articles/microservices-in-practice-1
----
The foundation of microservices architecture(MSA) is about developing a single application as a suite of *small* and *independent* services that are running in its own process, developed and deployed independently.
----

* isolated
* reusable

.https://dzone.com/articles/microservices-in-practice-1
----
In the context of SOA, SOA governance guides the development of reusable services, establishing how services will be designed and developed and how those services will change over time.
----

* disposable

The need of *failing fast* 

To guarantee those last, a classic technical stack emerged around the following component:

* API Gateway
* Service Discovery
* Load Balancer
* Circuit Breaker
	** bulkheads
	** fallbacks
* Centralised configuration (?)
* monitoring and logging
* security

== Demo et applications

* Spring

* MicroProfile

On prendrait quelle implÃ©mentation pour nos tests ?

* OpenLiberty (IBM) est la plus Ã  jour quant Ã  la version d'Eclipse MicroProfile
* Thorntail (ex Wildfly Swarm, RedHat) est "Thorntail, in its 2.1.0.Final version, is the first MicroProfile container to use the SmallRye implementation." +
Voir https://developers.redhat.com/blog/2018/08/23/eclipse-microprofile-and-red-hat-update-thorntail-and-smallrye/

== Resources

* Microservices "core" :
	** https://fr.slideshare.net/BenWilcock1/microservices-java-ee-vs-spring-boot-and-spring-cloud : old (2016) but GREAT RESOURCE
		**** the associated GitHub repo is also very good (https://github.com/benwilcock/cqrs-microservice-sampler) +
		A detailed explanation of the work done is also available at https://benwilcock.wordpress.com/2016/06/20/microservices-with-spring-boot-axon-cqrses-and-docker/
	** https://dzone.com/articles/microservices-in-practice-1: good def of all elements of the microservices stack
	** Pragmatic Microservices: https://medium.com/microservices-in-practice/microservices-in-practice-7a3e85b6624c TRES BON +
	Une autre bonne prÃ©sentation des diffÃ©rents Ã©lÃ©ments de la stack microservices
	** Toutes les explications du site Eclipse.org sur les bases des microservices et fonctions associÃ©es (gateway, service discovery) sont trÃ¨s bien faites. Exemple : https://www.eclipse.org/community/eclipse_newsletter/2017/september/article5.php
	** *applications cloud-native* un bon schÃ©ma et une def courte et claire "L'approche Cloud-native est la faÃ§on dont les applications sont crÃ©Ã©es et dÃ©ployÃ©es, non pas oÃ¹ elles sont exÃ©cutÃ©es." : https://www.supinfo.com/articles/single/5015-qu-est-ce-qu-une-application-cloud-native

* Spring Boot and Cloud microservices :
	** Quick Guide to Microservices With Spring Boot 2.0, Eureka, and Spring Cloud : https://dzone.com/articles/quick-guide-to-microservices-with-spring-boot-20-e

* Eclipse MicroProfile :
	** cette suite d'articles d'Eclipse.org, traitent Ã©galement de l'env tech autour des microservices : https://www.eclipse.org/community/eclipse_newsletter/2017/september/
	** Red Hat's implementation of Eclipse MicroProfile, WildFly Swarm, has been renamed to *Thorntail*.
	** Eclipse MicroProfile Releases and associated implementation: https://wiki.eclipse.org/MicroProfile/Implementation
	** Here comes *SmallRye*, a shared Eclipse MicroProfile implementation: https://developers.redhat.com/blog/2018/08/23/eclipse-microprofile-and-red-hat-update-thorntail-and-smallrye/
	** dev "core" de microservices avec MicroProfile (sans l'env tech adjacent) : https://www.baeldung.com/eclipse-microprofile

	** env tech avec MicroProfile, voir *KumuluzEE* (Java Dukeâ€™s Choice Award Winner) which provides support for service discovery by introducing simple annotations for REST services: https://ee.kumuluz.com/microprofile +
	-> problÃ¨me : KumuluzEE is fully compliant with Eclipse MicroProfile 1.0, 1.1 and 1.2. -> donc pas les versions les plus rÃ©centes
	** Toujours sur KumuluzEE, que l'on pourrait voir comme un concurrent de Spring Cloud : https://piotrminkowski.wordpress.com/tag/microprofile/
	+
	----
	*Whatâ€™s KumuluzEE*
	Can KumuluzEE be a competitor for the Spring Cloud framework? He is certainly not as popular and advanced in the solutions for microservices like Spring Cloud, but has basic modules for service registration, discovery, distributed configuration propagation, circuit breaking, metrics and support for Docker and Kubernetes. It uses CDI on JBoss Weld container for dependency injection and Jersey as a REST API provider. Modules for configuration and discovery basing on Consul or etcd and they are rather on early stage of development (1.0.0-SNAPSHOT), but letâ€™s try it out.
	----
	** RAHHHH, Istio Istio Istio qui semble Ãªtre une solution de plus en plus prÃ©co pour MP : https://www.eclipse.org/community/eclipse_newsletter/2018/september/MicroProfile_istio.php (en plus un article rÃ©cent !) -> *A LIRE ABSOLUMENT !!!!*
	** l'eBook "Building Microservices with Enterprise Java: A Practical Guide to Eclipse MicroProfile" http://bit.ly/MP-ebook, 62 pages 2018/10, A REGARDER

* *Comparaison entre Spring Boot / Cloud et MicroProfile* :

	** https://www.ibm.com/blogs/bluemix/2018/09/migrate-java-microservices-from-spring-to-microprofile-p1/ : TrÃ¨s bonne ressource
		**** code source avec Spring : https://github.com/ibm-cloud-architecture/refarch-cloudnative-kubernetes/tree/spring
		**** code source avec MicroProfile : https://github.com/ibm-cloud-architecture/refarch-cloudnative-kubernetes/tree/microprofile

	** Pour la partie vraiment "core" du dev des microservices : https://developers.redhat.com/blog/2018/11/21/eclipse-microprofile-for-spring-boot-developers/ +
	-> Article trÃ¨s rÃ©cent, 21/11/2018 +
	-> *Attention*, cela ne couvre PAS l'environnement technique adjacent (API gateway, service discovery, etc.)

	** Pour une comparaison du Health check, voir https://medium.com/ibm-cloud/java-microservices-with-microprofile-health-check-and-metrics-cd70cf529626

	** Pour une comparaison de 2 jours de workshops (plan de formation Oxiane) pour bÃ¢tir une application microservices, l'un avec MicroProfile, l'autre avec Spring, voir : https://www.oxiane.com/voxxeddays-microservices/ +
	TRES SYMPA POUR AVOIR *UN LISTING DE TECHNO CLASSÃ‰ PAR CATÃ‰GORIE* :
		**** (WS2) Microservices en Java (Spring) : https://www.oxiane.com/wp-content/uploads/2018/06/Voxxed-Microservices-2018-Programme-Formation-WS2-Spring-Cloud.pdf

			----
			Architecture microservices

			Gateway (Zuul, Traefik)
			Registry et service discovery (Eureka, Consul et Istio)
			Monitoring (stack Elastic, Prometheus)
			Cache distribuÃ© (Hazelcast, Ehcache, Infinispan, Memcached)
			SÃ©curitÃ© avec Spring Security (et un dÃ©tail des modifications/amÃ©liorations proposÃ©es par JHipster)

			DÃ©veloppement de plusieurs microservices

			Spring Boot et Spring Cloud pour dÃ©marrer rapidement une gateway et des microservices
			Netflix Eureka ou Consul pour gÃ©rer lâ€™annuaire de services
			Spring Cloud Config pour configurer lâ€™ensemble de lâ€™architecture
			SÃ©curitÃ© JWT ou OAuth2 (avec Keycloak)
			API gateway avec Zuul
			Monitoring avec la stack Elastic
			Docker pour tester facilement lâ€™ensemble de lâ€™architecture localement, et pour passer en production
			----

		**** (WS1) Microservices en Java (Java EE) : https://www.oxiane.com/wp-content/uploads/2018/06/Voxxed-Microservices-2018-Programme-Formation-WS1-Jakarta-EE.pdf 

			----
			Architecture microservices

			Registry et service discovery (Config, OPen API, Consul)
			ScalabilitÃ© (Fault Tolerance)
			Monitoring (Open Tracing + Metrics + Health Check)
			SÃ©curitÃ© (JWT + JWT Propagation)

			DÃ©veloppement de plusieurs microservices

			Services REST (JAX-RS + CDI)
			Parsing JSON (JSON-P + JSON-B)
			Consul pour gÃ©rer lâ€™annuaire de services
			Config pour configurer lâ€™ensemble de lâ€™architecture
			SÃ©curitÃ© JWT et propagation des tokens JWT
			Monitoring
			Docker pour tester facilement lâ€™ensemble de lâ€™architecture localement, et pour passer en production
			----

	** *A lire absolument* (mars 2019, viens de sortir) : https://dzone.com/articles/programming-styles-spring-boot-vis-a-vis-with-ecli et sa suite https://dzone.com/articles/programming-styles-compared-spring-framework-vis-a


* Microservices reference architecture (IBM) : https://www.ibm.com/cloud/garage/architectures/microservices/reference-architecture
	** Jeter Ã©galement un oeil au "Get started with a microservices architecture" qui est dispo avec
* Cast Codeurs 204, sur Netflix qui abandonne le dÃ©veloppement de sa stack OSS au profit du fork que Spring a rÃ©alisÃ© dessus ("eureka" remplacÃ© par "spring-eureka", Ã  revÃ©rifier)
* Cast Codeurs 207, vÃ©rifier, mais apparemment l'implÃ©mentation Thorntail de MicroProfile est en passe d'Ãªtre abandonnÃ©e
* 12@13 d'Antonio GONCALVES sur l'architecture microservices
* RefCardz Spring Boot et microservices

* repo de Darren : https://gitlab.com/darren.boutros/devoxx-2019/tree/find_Mission/Spring-Cloud/mission/src/main

=== Reminders

.https://thenewstack.io/from-monolith-to-microservices/
----
Alistair Cockburn introduced the â€œports and adaptersâ€ pattern, also called hexagonal architecture, in the context of building applications that can be tested in isolation. However, it has been increasingly used for building reusable microservices-based systems, as advocated by James Gardner and Vlad Mettler. A hexagonal architecture is an implementation of a pattern called  bounded context, wherein the capabilities related to a specific business domain are insulated from any outside changes or effects.
----

.What are microservices? - https://hub.packtpub.com/capability-model-microservices/
----
Microservices originated from the idea of Hexagonal Architecture coined by Alister Cockburn. Hexagonal Architecture is also known as thePorts and Adapters pattern.
----

.Microservices definition from Alistair Cockburn
----
Microservices originated from the idea of Hexagonal Architecture coined by Alister Cockburn. Hexagonal Architecture is also known as the Ports and Adapters pattern.

Microservices is an architectural style or an approach to building IT systems as aset of business capabilities that are autonomous, self-contained, and loosely coupled.
----

For this last ref, check:

* https://hub.packtpub.com/microservices-and-service-oriented-architecture/
* https://hub.packtpub.com/capability-model-microservices/

Good characteristics for microservices: https://stackoverflow.com/questions/48653762/how-microservices-are-different-from-isolated-standalone-service

Especially do not forget the argument on *independent life cycles* to use Conway's law to your advantage.

* https://blog.bernd-ruecker.com/3-common-pitfalls-in-microservice-integration-and-how-to-avoid-them-3f27a442cd07: excellent ref

----
Microservices are about decomposition, but giving each component a high degree of autonomy and isolation
----

This link also explains the importance of *failing fast*

* Parlez de CQRS / ES, et donc prÃ©voir quelques mots sur *Axon framework*. 

* Il faudra peut-Ãªtre (en fait, *SUREMENT*) Ã©galement commencer par dire 2 mots sur la comparaison entre plateforme, comme *Istio*, et frameworks, comme *Spring* et *MicroProfile*, pour l'env tech des microservices. +
A ce sujet, voir la prez Ã  Devoxx UK 2018 de Kate Stanley & Adam Pilkington (IBM) : https://www.youtube.com/watch?v=lFj8X0VLOFQ

Pour rappel : "Istio is an Open *platform* to connect, manage and secure microservices" +
Il prend en charge les fonctionnalitÃ©s suivantes :

* Service Mesh
* Intelligent Routing and Load Balancing
* Fault Tolerance
* Policy Enforcement
* Metrics, Logging, Observability, Visualisation
* Service Identity and Security

Concernant Istio, le side car *Envoy* rÃ©alise les fonctionnalitÃ©s suivantes :

* High performance C++ Proxy
* Load balancing
* Circuit breaking
* Health checks
* Fault injection

==== Kubernetes as a replacement for service registry, discovery and load balancing instead of Netflix OSS

Cette tendance se confirme de plus en plus, bien aidÃ©e par l'avÃ¨nement de l'industrialisation des containers.

check https://www.ibm.com/blogs/bluemix/2017/05/key-decisions-when-building-microservices-apps-in-java-with-kubernetes/ :

----
Q3: How do I handle application service registry and discovery?

To benefit from the many Microservices you create in a distributed, elastic cloud environment, a proper service registration and discovery strategy is critical to allow them to communicate with each other or to be consumed. As a pioneer in cloud-native Microservices implementation, Netflix has built and released a set of opinionated libraries known as Netflix OSS, such as Eureka, Zuul, Ribbon, etc. And they are well integrated with the Spring framework. Typically, services are registered to Eureka, and Ribbon/Zuul handle the service discovery and basic load-balancing. However, what I describe was nearly 5 years ago.

Today, Kubernetes natively supports service registry, discovery and load balancing. You no longer need Netflix OSS for these tasks. Instead, you design the system the Kubernetes way. You can leverage Kubernetesâ€™ Service type to expose your Microservices, then it automatically registered into Kubernetes system via virtual IP or DNS approach (Iâ€™ll elaborate on this decision in the next question/answer). The discovery will be through the familiar DNS lookup style. For Service-based clusters, Kubernetes provides a built-in load balancer to distribute the workload among Pods (containers).
----

Voir Ã©galement https://www.ibm.com/blogs/bluemix/2018/09/migrate-java-microservices-from-spring-to-microprofile-p1/ :

----
However, the move to Kubernetes mostly obfuscated the need for Spring Cloud capabilities, as most of our microservice capabilities were supported out of the box by Kubernetes (with some minor exceptions like Hystrix fault tolerance support).
----

== Teaser et abstract

*Titre* :

* Microservices war! Spring vs Microprofile!
* Microservices battlefield! Spring vs Microprofile!
* *Microservices: Infinity War! Spring vs MicroProfile*

*ThÃ¨mes* : Cloud, Containers et Infrastructure, DevOps

*Niveau* : ouvert Ã  tout niveau d'audience, dÃ©butant comme expert

*Type de prÃ©sentation* : Slides et du code

*Abstract* :

idÃ©es Ã  dÃ©velopper dans l'abstract : 

* environnement technique complexe
* donc on utilise des frameworks pour se simplifier la vie
* Spring, Boot et Cloud, est omniprÃ©sent, mais MicroProfile est maintenant un challenger
* peut-il espÃ©rer concurrencer Spring ?

----
En ce dÃ©but 2019, et avec maintenant quelques annÃ©es de recul (et quelques crises de nerf ?) sur le sujet, tout le monde s'accorde Ã  dire que l'environnement technique nÃ©cessaire Ã  la mise en place de **microservices** est complexe :
API gateway, service discovery et registry, design for failures et circuit breaker, gestion de la sÃ©curitÃ© via OAuth et OpenID Connect, et j'en passe...

Le framework **Spring**, plus particuliÃ¨rement les projets **Boot** et **Cloud**, a permis Ã  bien des dÃ©veloppeurs de prÃ©server (une partie de ? ðŸ˜‰ ) leurs cheveux en facilitant cette mise en place.
Mais est-il seul roi en son domaine, ou existe-t-il des alternatives ?
CrÃ©Ã© fin 2016 sur base de Java EE 7, le projet **Eclipse MicroProfile** a justement pour objectif d'optimiser la plateforme Java EE pour les architectures microservices.
Pourra-t-il concurrencer l'hÃ©gÃ©monie du premier ?

Durant cette universitÃ©, **nous comparerons les forces et faiblesses** de ces 2 plateformes via le **dÃ©veloppement simultanÃ©, pour chacune d'elles, d'une mÃªme application**.  
Vous pourrez ainsi, en toute connaissance de cause, choisir de rester sur votre Spring, ou au contraire basculer sur le nouveau MicroProfile ðŸ˜‰
----

Message pour le comitÃ© :

----
Bonjour,

Le but de cette universitÃ© est de **comparer les possibilitÃ©s des frameworks Spring et MicroProfile pour le dÃ©veloppement de microservices**, et leurs facilitÃ©s d'intÃ©gration avec les outils du marchÃ© (Netflix OSS, stack Hashicorp avec Consul & Co, mais aussi l'omniprÃ©sent Istio du moment, etc.) assurant la qualitÃ© de service requise par les applications cloud-native (service discovery, load balancing, gestion des erreur, configuration centralisÃ©e, etc.).

On ne va pas se mentir, actuellement, pour le dÃ©ploiement de microservices, Spring est de loin la stack la plus connue et utilisÃ©e.  
Or justement, nous voudrions justement montrer qu'elle n'est pas la seule, et que l'on peut **faire de belles choses avec notre "bon vieux" Java Enterprise**, ici avec MicroProfile ðŸ˜‰

Au final, nous voulons qu'en sortant de l'universitÃ©, les participants sachent qu'elles sont les forces et faiblesses de chaque stack, et s'ils doivent en choisir eux-mÃªmes une Ã  l'avenir, ne se contente plus d'un "Spring par dÃ©faut".

CÃ´tÃ© speakers, Darren et moi faisons partie du **JUG Interne de Softeam depuis des annÃ©es**.  
Pour une petite idÃ©e de notre activitÃ©, voir [les CR de nos rÃ©unions mensuelles sur GitHub](https://github.com/softeamfr/startech-meetings-reports).  
Nous sommes tous deux des devs seniors avec plus de 12 et 15 ans d'expÃ©rience, et plusieurs annÃ©es d'architecture derriÃ¨re nous.  
Via notre activitÃ© au JUG (voir [cette prÃ©sentation](https://ardemius.github.io/slides-startech/slides-starTECH.html) pour plus de dÃ©tails sur celle-ci) nous avons dÃ©jÃ  donnÃ© de nombreuses formations aux dÃ©veloppeurs de la sociÃ©tÃ©, sur des sujets variÃ©s (*Java core*, *Lambdas*, *optimisation*, *Spring*, *Git*, *TDD*, *AsciiDoctor*, etc.), nous avons donc l'habitude de prendre la parole en public.

Darren a Ã©tÃ© **enseignante en universitÃ© pendant 6 ans** sur UML, ainsi qu'en dÃ©veloppement web en Java / Java EE.  
De mon cÃ´tÃ©, **j'ai dÃ©jÃ  Ã©tÃ© speaker Ã  Devoxx France en 2017**, avec le sujet ["Sorcellerie en Java : outrepasser les interdits avec sun.misc.Unsafe"](https://cfp.devoxx.fr/2017/talk/FEU-0240/Sorcellerie_en_Java_:_outrepasser_les_interdits_avec_sun.misc.Unsafe.html) ([YouTube](https://youtu.be/FytJ4OdGYPM)), avec lequel j'avais Ã©galement gagnÃ© le Young Blood du Paris JUG la mÃªme annÃ©e ([YouTube](https://youtu.be/mPvhzKLb9K0))  
Je fais Ã©galement parti du pÃ´le formation de Softeam, tout particuliÃ¨rement concernant Git.  
Une bonne partie de mon activitÃ© et ma veille est visible sur mes repo GitHub : [https://github.com/Ardemius](https://github.com/Ardemius)
----

Mots clÃ©s : microservices, Spring, MicroProfile, (Java EE)

== PrÃ©sentation

AbrÃ©viations :

* l1 : Spring Microservices in Action
* l2 : MicroProfile

=== Intro

Les microservice c'est quoi ? A quoi servent-ils et Ã  quels besoins nos 2 stacks doivent-elles rÃ©pondre ?

DÃ©finition d'Alistair COCKBURN + reminder p13

Microservices are *distributed systems*

Characteristics of microservices : (Voxxed microservices 2018 - Distant Path of Microservices)

* retries (importance de ce point confirmÃ© dans "For a Future Microservices Journey")
* transaction manager
* Command objects
* service registry
* caching

Insister sur *l'environnement autour des microservices*, et reprendre l'excellent schÃ©ma de Susanne Kaiser lors du Voxxed Microservices Preparing "For a Future Microservices Journey"

notion d'isolation pour les microservices (trouver une ref plus prÃ©cise), or l'isolation amÃ¨ne la redondance (DRY PLUS coupling OR isolation PLUS redundancy -> les microservices prÃ©fÃ¨rent le 2nd, cf conf VM "Hexagonal at Scale, with DDD and microservices!")

=== Microservices "core"

l1 p19 - 20 : les principales caractÃ©ristiques

Bien parler de la *communication entre microservices* : 

* synchrone : tight coupling, REST calls
* *asynchrone* : Rabbit / Kafka, loose coupling +
C'est bien ce type de comm qui est prÃ©conisÃ© la plupart du temps pour les microservices -> CHECKER QU'ON L'INTEGRE BIEN DANS LA DEMO

-> pour ce point, voir https://dzone.com/articles/how-are-your-microservices-talking, qui repropose Ã©galement une def des microservices

=== L'environnement autour des microservices (API Gateway, service discovery, fail-fast, etc.)

* Hystrix et, de plus en plus, ses remplaÃ§ants : l'abandon d'#Hystrix au profit de #Resilience4j et #AdaptiveConcurrencyLimits (cf Fabrice Volkaert @volkaert)

=== PrÃ©sentation de Sprint Boot et Cloud

Cf l1 p34 : dÃ©finition de Spring Boot et Cloud

Refcardz DZone : Spring boot pas d'app server comparÃ© Ã  JEE classique : "Specifically, Spring Boot is concerned with building "bootable" applications that can boot up on bare metal or virtualized infrastructure without any elaborate ecosystem such as application servers or web containers".

=== PrÃ©sentation de Microprofile

Parler de Thorntail (anciennement Wildfly Swarm), Open Liberty, Payara, TomEE et mentionner qu'il existe d'autres implÃ©mentations de MicroProfile.
-> Voir https://developers.redhat.com/blog/2018/11/21/eclipse-microprofile-for-spring-boot-developers/

=== Live Demo

* On commence par une rapide prÃ©sentation de ce que va faire la dÃ©mo

Bonne ressources Ã  exploiter : https://developers.redhat.com/blog/2018/11/21/eclipse-microprofile-for-spring-boot-developers/

* IL VA FALLOIR UN PETIT DIAGRAMME DE CLASSE (diagramme d'archi) DE LA DEMO
* et lister les techno utilisÃ©es pour chaque stack

* Bien dÃ©couper la dÃ©mo, Ã©lÃ©ment (classe) par Ã©lÃ©ment dont on prÃ©sentera l'implÃ©mentation successivement, en comparant systÃ©matiquement les stacks Spring et MicroProfile 
	** trouver un moyen simple d'afficher Ã  l'Ã©cran, pour un mÃªme Ã©lÃ©ment, les codes Spring et MicroProfile (via l'IDE ? 2 workspaces / projects en parallÃ¨le ?)
	** voir si on intÃ¨gre un peu de code dans les slides

-> DANS TOUS LES CAS, venir le jour J avec plusieurs backups du code source COMPLET

=== Conclusion de la demo

* Etudier les possibilitÃ©s de "mixer / mÃ©langer" les 2 stacks
* Parler (rapidement) des possibilitÃ©s d'implÃ©menter ses microservices "Ã  la main", sans framework tierce

On vous a parlÃ© de crÃ©ation de microservices avec stack Spring et MicroProfile, mais d'autres solutions sont possibles, comme l'usage d'Istio (notion de *service mesh*). +
Rentrer dans le dÃ©tail serait l'objet d'une prÃ©sentation Ã  part, mais on peut rapidement en dire ceci : bla bla bla (en faire une rapide prÃ©sentation)

Pour un bon schÃ©ma de ce qu'est un service mesh, cf "For a Future Microservices Journey"

=== L'avenir

* gRPC poussÃ© par l'omniprÃ©sence de Kubernetes, la caractÃ©ristique HTTP / REST / JSON des microservices va peut-Ãªtre (sÃ»rement ?) Ã©voluer +
-> voir la vidÃ©o "Intro to gRPC: A Modern Toolkit for Microservice Communication" (https://www.youtube.com/watch?v=RoXT_Rkg8LA)
	** voir Ã©galement ce que pourrait donner GraphQL Ã  la place de REST Ã  ce sujet. Voir le blog d'Octo https://blog.octo.com/graphql-et-pourquoi-faire/, le plus important :
	"*Lâ€™optimisation des requÃªtes* ainsi que *lâ€™optimisation des donnÃ©es rÃ©seaux* sont Ã  mon sens les deux avantages majeurs de GraphQL Ã  lâ€™Ã©tat de lâ€™art."
* Netflix arrÃªte le support de sa stack OSS pour supporter les outils Spring issus du fork de cette derniÃ¨re (Ã  checker, voir les Cast Codeurs 204)

== Dans l'absolu

* PlutÃ´t vers le dÃ©but, on pourrait parler un peu de la *dÃ©composition du problÃ¨me mÃ©tier*, et donc du DDD 

* "Comme son titre l'annonce, cette prÃ©sentation a pour but de comparer les stacks Spring, avec Boot et Cloud, et MicroProfile pour le dÃ©veloppement d'une application basÃ©e sur une architecture microservices +
Donc, avant d'aller plus loin, commenÃ§ons par rappelez ce qu'on entend exactement par architecture microservices."
* "Rapide sondage : qui a dÃ©jÃ  utilisÃ© ou utilise des microservices dans son projet ?"
	** Parmi celles et ceux qui ont rÃ©pondu "oui", vos microservices reposent-ils principalement sur une stack Spring ?
	** une stack MicroProfile ?
	** ou aucune des 2, et vous faites tout Ã  la main !!!! (rÃ©flÃ©chir Ã  la pertinence de la question)

== PLAN au 01/04/2019

1. rapide dÃ©finition de ce qu'est un microservice et un peu d'histoire
2. le "core" des microservices
3. puis tout l'environnement qui gravite autour. On va y distinguer :
	** API Gateway
	** Service Discovery
	** Load Balancer
	** Design for failure
		**** Circuit Breaker
		**** bulkheads
		**** fallbacks
	** Centralised configuration
	** monitoring and logging
	** security
-> bien faire une prÃ©sentation *AGNOSTIQUE Ã  la techno* Ã  ce niveau. +
Faire un schÃ©ma global sur la modÃ¨le de celui de Susane KAISER lors du Voxxed Days microservices 2018

ON PLACE LES 15 20 min de pause ICI ! 

4. Passage Ã  la pratique et demo
	** PrÃ©sentation de la stack Spring Boot et Cloud
	** PrÃ©sentation de la stack Microprofile -> ON PART SUR *OPEN LIBERTY*
		**** prÃ©senter les principales implÃ©mentations de la spec MicroProfile (et donner la derniÃ¨re version actuelle !)
	** PrÃ©sentation exhaustive des technos que nous avons choisies pour les 2 stacks 
		**** Spring
		**** MicroProfile
			****** JAX-RS
			****** CDI
5. Conclusion : rÃ©capitulatif des points communs / diffÃ©rences entre les 2 stacks
6. On se projette dans l'avenir...
	** les protocoles de communications : gRPC poussÃ© par Kubernetes, et GraphQL
	** "l'autre combattant" Kubernetes (avec le service mesh Istio)
7. On rÃ©serve 10 min pour les questions

-> Au total, ~2h30 de prÃ©sentation (slides et demo)

=== 1 rapide dÃ©finition de ce qu'est un microservice et un peu d'histoire

ConfÃ¨re le livre Spring in action (voir pages annotÃ©es) : microservices comme principal architecture pattern pour le dÃ©veloppement d'application cloud +
-> Les applications cloud (native ?) sont un 1er use case, le 2nd Ã©tant la migration d'un monolithe vers une application microservices 

